<script>
$(document).ready(function(){       
    let url = <%- JSON.stringify(url) %>;
    let edit = <%- JSON.stringify(edit) %>;

    let table = $("#tests").DataTable({
    ajax: {
        url: url,
        dataSrc: ""
    },        
    pageLength: 25, // show 25 entries
    columns: [
        {
            data: "name"
        },
        {
            data: "manualIds",
            render: function (ids) {
                return displayIds(ids);                    
            }
        },
        {
            data: "automatedIds",
            render: function (ids) {
                return displayIds(ids);                    
            }
        },
        {
            data: "description"
        }],
    drawCallback: function(settings){            
        let index = url.lastIndexOf("/");                  
        let activeItem = url.substring(index + 1);            
        $("#" + activeItem).addClass("active");
    }
        
});    

    // $("input").on('keyup', function() {
        
    //     let val = $(this).val();

    //     if(!isNaN(val)){
    //         // combine search into two columns
    //         let regExSearch = "^(" + val + ")"; // works 
        

    //         // table.column(2).search(regExSearch, true, false);
    //         table.column(1).search(regExSearch, true, false).draw();
        
        
        
    //     } else {
    //         table.search(val, false, true).draw();
    //     }
    // });

    function displayIds(ids) {    
        let values = "";

        for (let i = 0; i < ids.length; i++) {
            if (ids[i] === "") {
                return "MISSING";
            }

            let editTestLink = edit + ids[i];
            values += "<a href='" +  editTestLink + "' target='_blank'>" + ids[i] + "</a>" + " ";
        }

        return values;
    }    
});
</script>